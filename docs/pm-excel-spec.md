# PM 의사결정: 엑셀/CSV 분석 기능

> 작성일: 2026-02-08
> 버전: 1.0

---

## 1. 기능 스펙

### 1.1 기능 개요
| 항목 | 내용 |
|------|------|
| 기능명 | 엑셀/CSV 데이터 분석 |
| 우선순위 | P1 |
| 목표 | 업로드한 스프레드시트 데이터를 AI로 분석 |
| 타겟 사용자 | 데이터 분석이 필요한 사무직 |

### 1.2 핵심 기능 (MVP)
1. **파일 업로드**: 드래그앤드롭 / 파일 선택
2. **지원 포맷**: .xlsx, .xls, .csv
3. **데이터 미리보기**: 첫 10행 테이블 표시
4. **AI 분석**: 데이터 요약, 질문 응답

### 1.3 확장 기능 (Post-MVP)
- 차트 시각화
- 여러 시트 선택
- 데이터 필터링 UI
- 분석 결과 내보내기

---

## 2. 기술 스펙

### 2.1 의존성
```json
{
  "xlsx": "^0.18.5",
  "papaparse": "^5.4.1"
}
```

### 2.2 컴포넌트 구조
```
src/lib/
├── skills/
│   └── spreadsheet.ts    # 파싱 로직
├── components/
│   ├── FileUpload.svelte # 파일 업로드 UI
│   └── DataPreview.svelte # 테이블 미리보기
```

### 2.3 데이터 플로우
```
파일 업로드 → 파싱 → 미리보기 표시
                  ↓
            AI 프롬프트에 데이터 포함
                  ↓
            Ollama 분석 → 결과 표시
```

---

## 3. UI/UX 스펙

### 3.1 파일 업로드 영역
- 채팅 입력창 옆에 📎 아이콘 버튼
- 클릭 시 파일 선택 다이얼로그
- 드래그앤드롭 영역 (채팅 전체)

### 3.2 미리보기
- 파일 업로드 즉시 채팅에 미리보기 카드 표시
- 테이블: 최대 10행 × 전체 컬럼
- 메타정보: 총 행수, 컬럼수, 파일명

### 3.3 예시 UI
```
┌──────────────────────────────────────┐
│ 📊 매출데이터.xlsx                    │
│ 1,234행 × 8컬럼                       │
├──────────────────────────────────────┤
│ 날짜     | 매출   | 지역   | ...      │
│ 2024-01  | 150000 | 서울   | ...      │
│ 2024-02  | 180000 | 부산   | ...      │
│ ... (8행 더 있음)                     │
├──────────────────────────────────────┤
│ [데이터 분석하기]                     │
└──────────────────────────────────────┘
```

---

## 4. 제한사항

| 제한 | 값 | 이유 |
|------|-----|------|
| 최대 파일 크기 | 10MB | 메모리 |
| AI 전송 최대 행 | 100행 | 컨텍스트 윈도우 |
| 지원 시트 | 첫 번째만 | MVP 단순화 |

---

## 5. 구현 우선순위

| 순서 | 태스크 | 필수/선택 |
|------|--------|----------|
| 1 | 라이브러리 설치 | 필수 |
| 2 | spreadsheet.ts 스킬 | 필수 |
| 3 | FileUpload 컴포넌트 | 필수 |
| 4 | DataPreview 컴포넌트 | 필수 |
| 5 | 채팅 통합 | 필수 |
| 6 | AI 프롬프트 최적화 | 필수 |
| 7 | 에러 핸들링 | 필수 |
| 8 | 테스트 | 필수 |

---

## 6. 예상 작업량

| 카테고리 | 시간 |
|----------|------|
| 개발 | 3-4시간 |
| 테스트 | 30분 |
| 문서 | 30분 |
| **총계** | **4-5시간** |

---

## 7. 완료 기준

- [ ] .xlsx, .csv 파일 파싱 성공
- [ ] 미리보기 테이블 표시
- [ ] AI 분석 연동 동작
- [ ] pnpm build 성공
- [ ] 단위 테스트 통과

---

## 8. 리스크 & 완화

| 리스크 | 영향 | 완화 방법 |
|--------|------|----------|
| 대용량 파일 | 브라우저 멈춤 | 10MB 제한 + 경고 |
| 한글 깨짐 | UX 저하 | 인코딩 감지 로직 |
| 복잡한 엑셀 | 파싱 실패 | try-catch + 에러 메시지 |

---

## 9. 의사결정 로그

| 결정 | 선택 | 대안 | 이유 |
|------|------|------|------|
| 엑셀 라이브러리 | SheetJS | ExcelJS | 브라우저 지원 |
| CSV 라이브러리 | PapaParse | 내장 | 스트리밍, 인코딩 |
| 시각화 | 테이블만 | Chart.js | MVP 우선 |
| AI 전송 방식 | JSON 포함 | 별도 API | 단순화 |
